<head>
</head>
<body>

	<textarea id="input" style="width: 400px; height: 90%; resize: none">chicken 
chicken chicken
chicken chicken chicken </textarea>
	
	<button onclick=chicken2chickenASM(document.getElementById('input').value) > toChickenASM </button>
	<button onclick=chicken2Eggsembly(document.getElementById('input').value) > toEggsembly </button>

	<textarea id="output" readonly style="width: 400px; height: 90%; resize: none"></textarea>

	<textarea id="output_egg" readonly style="width: 400px; height: 90%; resize: none"></textarea>
	
	<script>	
		function chicken2chickenASM(input) {
			var output = [];
			var isNewToken = true;
			var optCode = "";
			document.getElementById('output').value = "";
			
			var input = input.replace(/[\r\n]/g, ' \r\n'); //handle zero chickens
			var linesArray = input.split(/[\r\n]+/);
			
			console.log(linesArray);
			
			console.log("LinesArray: "+linesArray);
			for (var i=0; i<linesArray.length; ++i) {
				var chickenCount = (linesArray[i].trim() == "")? 0 : linesArray[i].trim().split(/\s+/).length;
				console.log("Chickencount = " + chickenCount);
				
				switch (chickenCount) {
				case 0:
					if (isNewToken)
						optCode = "exit";
					else 
						optCode += " 0";
					break;
				case 1: 
					if (isNewToken)
						optCode = "chicken";
					else 
						optCode += " 1";
					break;
				case 2: 
					optCode = "add";
					break;
				case 3: 
					optCode = "substract";
					break;
				case 4: 
					optCode = "multiply";
					break;
				case 5:
					optCode = "compare";
					break;
				case 6: 
					optCode = "load";
					break;
				case 7: 
					optCode = "store";
					break;
				case 8:
					optCode = "jump";
					break;
				case 9:
					optCode = "char";
					break;
				default: 
					optCode = "push "+(parseInt(chickenCount)-10);
				}
				
				//load instruction is double-wide instruction
				isNewToken = (optCode !== "load");
				
				if (isNewToken) {
					document.getElementById('output').value += optCode + "\n";
					output.push(optCode);
				}
			}

			return output;
		}
		
		function chickenASM2Eggsembly(input) {
			var output = [];
			var asmEggsemblyConverter = {	asmEggsemblyMap : { exit: "axe", 
																substract: "fox", 
																multiply: "rootster", 
																load: "pick", 
																store: "peck", 
																jump: "fr", 
																char: "BBQ" },
																
											convertAsm2Egg : function(asm) {
												if (this.asmEggsemblyMap[asm]) {
													var str = this.asmEggsemblyMap[asm];
													return str.split(' ')[0]; 
												}
												return asm;
												
											}											
										};
		
			//handle raw string and line splitted input too
			var linesArray = (typeof(input) == "string") ? input.split(/[\r\n]+/) : input;
			
			for (var i=0; i<linesArray.length; ++i) {
				output.push(asmEggsemblyConverter.convertAsm2Egg(linesArray[i]));
				console.log(asmEggsemblyConverter.convertAsm2Egg(linesArray[i]));
			}

			return output;
		}
		
		function chicken2Eggsembly(input) {
			var chickenAsmArray = chicken2chickenASM(input);
			var eggsemblyArray = chickenASM2Eggsembly(chickenAsmArray);
			
			for (var i=0; i<eggsemblyArray.length; ++i) {
				document.getElementById("output_egg").innerHTML += eggsemblyArray[i] + "\n";
			}
		}
	</script>
</body>